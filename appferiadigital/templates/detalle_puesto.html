<!-- appferiadigital/templates/detalle_puesto.html -->
{% extends 'base.html' %}

{% block title %}Detalle del Puesto{% endblock %}

{% block content %}
<h2 class="mb-4">Puesto {{ puesto.numero_puesto|default:puesto.id_puesto }}</h2>

<div class="card mb-4">
    <div class="card-body">
        <p><strong>Feria:</strong> {{ puesto.id_feria.nombre_feria }}</p>
        <p><strong>Vendedor:</strong> {{ puesto.id_usuario.nombre }}</p>
        {% if puesto.id_feria.ubicacion_feria %}
        <p><strong>Ubicación:</strong> {{ puesto.id_feria.ubicacion_feria }}</p>
        {% endif %}
    </div>
</div>

<h4 class="mb-3">Productos Disponibles</h4>

<div class="row">
    {% for producto in productos %}
    <div class="col-md-6 col-lg-4 mb-3">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">{{ producto.nombre_producto }}</h5>
                <p class="card-text">
                    {% if producto.id_categoria %}
                    <strong>Categoría:</strong> {{ producto.id_categoria.nombre }}<br>
                    {% endif %}
                    <strong>Stock:</strong> {{ producto.stock }}
                </p>
                {% if producto.stock > 0 %}
                <form method="post" action="{% url 'crear_reserva' %}">
                    {% csrf_token %}
                    <input type="hidden" name="producto_id" value="{{ producto.id_producto }}">
                    <div class="input-group mb-2">
                        <input type="number" class="form-control" name="cantidad" min="1" max="{{ producto.stock }}" value="1" required>
                        <button type="submit" class="btn btn-success">Reservar</button>
                    </div>
                </form>
                {% else %}
                <button class="btn btn-secondary" disabled>Sin Stock</button>
                {% endif %}
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12">
        <div class="alert alert-info">No hay productos disponibles en este puesto.</div>
    </div>
    {% endfor %}
</div>

<a href="{% url 'lista_puestos' %}" class="btn btn-secondary">Volver</a>
{% endblock %}